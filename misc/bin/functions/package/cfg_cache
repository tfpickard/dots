#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# Package
# ══════════════════════════════════════════════════════════════════════════════

# ......................................................... Distribution install

usage() { echo "usage: $(basename $0) <path/file> [<hostname>]"; exit 1; }

ROOT=$HOME/build/cfg      # update master

[ $1 ] || usage
[ $# -eq 2 ] && host=.$2  # host dependent config

if [ -d $1 ] ;then
  mkdir -pv $ROOT$1$host || exit 1
  ditto copy "$(cp -rvf --preserve=mode --no-preserve=ownership $1/* $ROOT$1$host)"
else
  mkdir -pv $ROOT${1%/*} || exit 1
  ditto copy "$(cp -vf --preserve=mode --no-preserve=ownership $1 $ROOT$1$host)"
fi

# avoid unnecessary dotfile updates
ditto rm "$(find $ROOT$1$host -type l -name 'supervise' -exec rm -v {} \;)"  # ln supervise on cfg_install 

# vim: set ft=sh: #
